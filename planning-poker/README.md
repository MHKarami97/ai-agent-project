# Planning Poker

یک برنامه وب **Planning Poker** برای تیم‌های چابک (Agile) که امکان تخمین زمان استوری‌ها به‌صورت همزمان و تعاملی را فراهم می‌کند.

## ویژگی‌های برنامه

### قابلیت‌های اصلی

- **ایجاد و مدیریت اتاق**: میزبان می‌تواند اتاق جدیدی ایجاد کند و شناسه منحصربه‌فرد اتاق را با اعضای تیم به اشتراک بگذارد
- **پیوستن به اتاق**: اعضای تیم می‌توانند با استفاده از شناسه اتاق به جلسه بپیوندند
- **رای‌گیری**: شرکت‌کنندگان می‌توانند از بین مقادیر 1، 2، 3، 5، 8 و 13 (دنباله فیبوناچی) انتخاب کنند
- **نمایش آرا**: میزبان می‌تواند پس از اتمام رای‌گیری، آرا را نمایش دهد
- **تحلیل آماری**: نمایش میانگین، میانه، مد و اجماع آرا
- **ریست رای‌گیری**: میزبان می‌تواند پس از هر راند، رای‌گیری را ریست کند
- **مدیریت استوری**: امکان تعیین و بروزرسانی عنوان استوری فعلی
- **پیگیری وضعیت**: نمایش لحظه‌ای تعداد شرکت‌کنندگان و وضعیت رای‌دهی آن‌ها

### قابلیت‌های فنی

- **دو زبانه**: پشتیبانی کامل از فارسی (RTL) و انگلیسی (LTR)
- **حالت تاریک/روشن**: امکان تغییر تم با ذخیره‌سازی در `localStorage`
- **بدون نیاز به بک‌اند**: استفاده از IndexedDB برای ذخیره‌سازی داده‌ها
- **طراحی ریسپانسیو**: سازگار با تمام اندازه‌های صفحه (دسکتاپ، تبلت، موبایل)
- **به‌روزرسانی خودکار**: سیستم polling برای به‌روزرسانی لحظه‌ای اطلاعات
- **رابط کاربری مدرن**: طراحی زیبا با انیمیشن‌های روان

## ساختار پروژه

```
planning-poker/
├── index.html                 # فایل HTML اصلی
├── assets/
│   ├── style.css             # استایل‌های CSS
│   ├── script.js             # منطق JavaScript
│   └── translations.json     # فایل ترجمه‌های دو زبانه
└── README.md                 # مستندات
```

## نصب و راه‌اندازی

این برنامه نیازی به نصب وابستگی ندارد و از HTML، CSS و JavaScript خالص استفاده می‌کند.

### پیش‌نیازها

- یک وب‌سرور محلی یا سرور HTTP
- مرورگر مدرن با پشتیبانی از IndexedDB (Chrome، Firefox، Safari، Edge)

### راه‌اندازی محلی

1. فایل‌ها را در یک پوشه قرار دهید
2. اطمینان حاصل کنید فایل `Vazirmatn-font-face.css` در پوشه والد قرار دارد
3. با استفاده از یک وب‌سرور محلی، برنامه را اجرا کنید:

#### روش 1: با Python
```bash
# Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000
```

#### روش 2: با Node.js
```bash
npx http-server -p 8000
```

#### روش 3: با PHP
```bash
php -S localhost:8000
```

#### روش 4: با Live Server در VS Code
- افزونه Live Server را نصب کنید
- روی فایل `index.html` کلیک راست کرده و "Open with Live Server" را انتخاب کنید

4. مرورگر را باز کرده و به آدرس `http://localhost:8000` بروید

## نحوه استفاده

### ایجاد اتاق جدید (میزبان)

1. روی دکمه "ایجاد اتاق جدید" کلیک کنید
2. نام خود و نام اتاق را وارد کنید
3. روی "ایجاد" کلیک کنید
4. شناسه اتاق به‌صورت خودکار تولید می‌شود
5. شناسه اتاق را با اعضای تیم به اشتراک بگذارید (دکمه کپی)

### پیوستن به اتاق (شرکت‌کننده)

1. روی دکمه "پیوستن به اتاق" کلیک کنید
2. نام خود و شناسه اتاق را وارد کنید
3. روی "پیوستن" کلیک کنید
4. وارد اتاق شوید و منتظر شروع رای‌گیری باشید

### رای‌گیری

1. میزبان عنوان استوری را وارد می‌کند (اختیاری)
2. هر شرکت‌کننده یک کارت را انتخاب می‌کند
3. وضعیت رای‌دهی به‌صورت لحظه‌ای نمایش داده می‌شود
4. میزبان روی "نمایش آرا" کلیک می‌کند
5. نتایج و آمار به همه نمایش داده می‌شود
6. میزبان می‌تواند برای راند بعدی "ریست" کند

### تغییر تنظیمات

- **تغییر زبان**: آیکون کره زمین در هدر
- **تغییر تم**: آیکون خورشید/ماه در هدر

## معماری و تکنولوژی

### ذخیره‌سازی داده

برنامه از **IndexedDB** برای ذخیره‌سازی محلی داده‌ها استفاده می‌کند:

#### جداول (Object Stores)

1. **rooms**: اطلاعات اتاق‌ها
   - `id`: شناسه منحصربه‌فرد اتاق
   - `name`: نام اتاق
   - `hostId`: شناسه میزبان
   - `story`: عنوان استوری فعلی
   - `revealed`: وضعیت نمایش آرا
   - `createdAt`: زمان ایجاد

2. **participants**: شرکت‌کنندگان
   - `id`: شناسه خودکار
   - `userId`: شناسه کاربر
   - `name`: نام شرکت‌کننده
   - `roomId`: شناسه اتاق
   - `isHost`: آیا میزبان است؟
   - `joinedAt`: زمان پیوستن

3. **votes**: آرا
   - `id`: شناسه خودکار
   - `participantId`: شناسه شرکت‌کننده
   - `roomId`: شناسه اتاق
   - `value`: مقدار رای
   - `timestamp`: زمان ثبت رای

### الگوهای طراحی

- **Module Pattern**: کپسوله‌سازی منطق برنامه در یک ماژول مستقل
- **Revealing Module Pattern**: افشای فقط متدهای عمومی
- **Observer Pattern**: به‌روزرسانی خودکار با polling
- **Singleton Pattern**: یک نمونه از برنامه

### ویژگی‌های کد

- استفاده از `var` برای تعریف متغیرها
- کد تمیز و خودتوضیح بدون کامنت‌های غیرضروری
- استفاده از توابع callback برای عملیات‌های async
- مدیریت خطا در تعاملات دیتابیس
- بهینه‌سازی عملکرد با استفاده از transaction‌های دیتابیس

## قابلیت‌های پیشرفته

### سیستم به‌روزرسانی خودکار

برنامه هر 2 ثانیه وضعیت اتاق را بررسی می‌کند و در صورت تغییر، رابط کاربری را به‌روزرسانی می‌کند.

### تحلیل آماری

پس از نمایش آرا، موارد زیر محاسبه و نمایش داده می‌شود:

- **میانگین**: میانگین حسابی تمام آرا
- **میانه**: مقدار وسط آرا
- **مد**: پرتکرارترین مقدار(ها)
- **اجماع**: آیا همه آرا یکسان است؟

### مدیریت session

تنظیمات کاربر (زبان و تم) در `localStorage` ذخیره می‌شود و در بارگذاری‌های بعدی بازیابی می‌شود.

## مرورگرهای پشتیبانی‌شده

- Chrome 24+
- Firefox 16+
- Safari 10+
- Edge 12+
- Opera 15+

## محدودیت‌ها

- **بدون همگام‌سازی شبکه واقعی**: برنامه از IndexedDB محلی استفاده می‌کند، بنابراین هر کاربر باید روی یک دستگاه/مرورگر باشد
- **بدون احراز هویت**: هیچ سیستم احراز هویتی وجود ندارد
- **بدون تاریخچه**: داده‌های قدیمی به‌صورت خودکار پاک نمی‌شوند

## راهنمای توسعه

### افزودن مقادیر کارت جدید

در فایل `script.js`، آرایه `CARD_VALUES` را ویرایش کنید:

```javascript
var CARD_VALUES = [1, 2, 3, 5, 8, 13, 21, 34];
```

### افزودن زبان جدید

1. فایل `assets/translations.json` را باز کنید
2. کلید زبان جدید اضافه کنید (مثلاً `"ar"` برای عربی)
3. تمام کلیدهای ترجمه را اضافه کنید
4. در فایل `script.js`، مقدار پیش‌فرض `currentLanguage` را به‌روزرسانی کنید

### سفارشی‌سازی تم

در فایل `style.css`، متغیرهای CSS در `:root` و `[data-theme="dark"]` را ویرایش کنید.

## عیب‌یابی

### برنامه کار نمی‌کند

1. کنسول مرورگر را بررسی کنید (F12)
2. اطمینان حاصل کنید که از وب‌سرور استفاده می‌کنید (نه باز کردن مستقیم فایل)
3. حافظه IndexedDB را پاک کنید: DevTools > Application > Storage > Clear Site Data

### فونت نمایش داده نمی‌شود

1. اطمینان حاصل کنید فایل `Vazirmatn-font-face.css` در مسیر صحیح است
2. مسیر نسبی در `index.html` را بررسی کنید

### داده‌ها ذخیره نمی‌شوند

1. اطمینان حاصل کنید مرورگر از IndexedDB پشتیبانی می‌کند
2. بررسی کنید که حالت مرور ناشناس (Incognito) فعال نباشد
3. فضای ذخیره‌سازی مرورگر را بررسی کنید

## امنیت

- تمام داده‌ها به‌صورت محلی در مرورگر ذخیره می‌شوند
- هیچ داده‌ای به سرور ارسال نمی‌شود
- شناسه اتاق‌ها تصادفی تولید می‌شوند
- ورودی‌های کاربر پاک‌سازی می‌شوند

## مجوز

این پروژه آزاد و بدون محدودیت مجوز است.

## نویسنده

توسعه داده شده برای تیم‌های چابک که به ابزار ساده و کارآمد Planning Poker نیاز دارند.

## تماس و پشتیبانی

برای گزارش مشکلات یا پیشنهادات، می‌توانید issue ایجاد کنید یا pull request ارسال کنید.

---

**نکته**: این برنامه برای استفاده در شبکه محلی (LAN) طراحی شده است. برای استفاده از طریق اینترنت، نیاز به پیاده‌سازی بک‌اند با WebSocket یا API RESTful دارید.

